# ====================================
# prod 프로필 - 실제 운영환경 (Production)
# ====================================

spring:
  datasource:
    master:
      url: ${DB_MASTER_URL:jdbc:postgresql://store-db:5432/store_db}
      username: ${DB_USERNAME}
      password: ${DB_PASSWORD}
      driver-class-name: org.postgresql.Driver
      hikari:
        maximum-pool-size: ${DB_MASTER_POOL_SIZE:10}
        minimum-idle: ${DB_MASTER_MIN_IDLE:5}
        connection-timeout: 30000
        idle-timeout: 600000
        max-lifetime: 1800000
    replica:
      url: ${DB_REPLICA_URL:jdbc:postgresql://store-db:5432/store_db}
      username: ${DB_USERNAME}
      password: ${DB_PASSWORD}
      driver-class-name: org.postgresql.Driver
      hikari:
        maximum-pool-size: ${DB_REPLICA_POOL_SIZE:10}
        minimum-idle: ${DB_REPLICA_MIN_IDLE:5}
        connection-timeout: 30000
        idle-timeout: 600000
        max-lifetime: 1800000
  jpa:
    hibernate:
      ddl-auto: none
      naming:
        implicit-strategy: org.springframework.boot.orm.jpa.hibernate.SpringImplicitNamingStrategy
        physical-strategy: org.hibernate.boot.model.naming.CamelCaseToUnderscoresNamingStrategy
    properties:
      hibernate:
        format_sql: false
        dialect: org.hibernate.dialect.PostgreSQLDialect
    show-sql: false
  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS:kafka:9092}

# ====================================
# prod 환경 로그 레벨 (최소한의 로그)
# ====================================
logging:
  level:
    root: WARN
    com.groom.store: INFO
    org.springframework: WARN
    org.springframework.web: WARN
    org.hibernate: WARN
    org.hibernate.SQL: OFF
    org.hibernate.orm.jdbc.bind: OFF
    org.hibernate.type.descriptor.sql: OFF

  file:
    path: ${LOG_PATH:/var/log/store-service}

# Redis 설정 (ExternalName 서비스 사용)
spring.data.redis:
  host: ${REDIS_HOST:cache-redis}
  port: ${REDIS_PORT:6379}
  password: ${REDIS_PASSWORD:}

# Feign Client 설정
feign:
  clients:
    user-service:
      url: ${CUSTOMER_SERVICE_URL}
      connect-timeout: 3000
      read-timeout: 3000
      logger-level: basic
  client:
    config:
      user-service:
        connectTimeout: 3000
        readTimeout: 3000
        loggerLevel: basic

# Kafka Topic 설정
kafka:
  topics:
    store-info-updated: ${KAFKA_TOPIC_STORE_INFO_UPDATED:store.info.updated}
    store-deleted: ${KAFKA_TOPIC_STORE_DELETED:store.deleted}
